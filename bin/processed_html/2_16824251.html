<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><head><link href="../../src/css/general.css" rel="stylesheet" /></head><div class='.s-prose'>

<p>It's type <a href="http://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-790004.3.4" rel="noreferrer">defaulting</a> together with ghci's extended default rules.</p>

<p>Integer literals are polymorphic, they have the type <code>Num a =&gt; a</code> (since they stand for <code>fromInteger literal</code>). But when an expression shall be evaluated - necessary for printing its result, for example - the expression must be given a monomorphic type.</p>

<p>By itself,</p>

<pre><code>yesno 0
</code></pre>

<p>imposes the two constraints <code>Num a</code> and <code>YesNo a</code> on the <code>0</code>, and the entire expression would have the ambiguous type</p>

<pre><code>yesno 0 :: (Num a, YesNo a) =&gt; Bool
</code></pre>

<p>(it's ambiguous, since the type variable in the constraint is not reachable from the type on the right of the <code>=&gt;</code>).</p>

<p>Generally, ambiguous types are type errors, however, in some cases the ambiguity is resolved by instantiating the constrained type variable with a default type. The rules in the language specification are that a type variable can be defaulted if</p>

<blockquote>
  <p>In situations where an ambiguous type is discovered, an ambiguous type variable, <code>v</code>, is defaultable if:</p>
</blockquote>

<pre><code>- `v` appears only in constraints of the form `C v`, where `C` is a class, and
- at least one of these classes is a numeric class, (that is, `Num` or a subclass of `Num`), and
- all of these classes are defined in the Prelude or a standard library (Figures 6.2â€“6.3 show the numeric classes, and Figure 6.1 shows the classes defined in the Prelude.)
</code></pre>

<p>The constraint <code>(Num a, YesNo a)</code> meets the first two requirements, but not the third. So by the language standard, it is not defaultable and should be a type error.</p>

<p>However, ghci uses extended default rules and also defaults type variables constrained by classes not defined in the Prelude or the standard libraries.</p>

<p>It would then choose the default for a <code>Num</code> constraint here, unless an explicit default declaration is in scope, that would be <code>Integer</code>, or, if <code>Integer</code> does not satisfy the constraints, <code>Double</code> is tried.</p>

<p>So when you have an <code>instance YesNo Integer</code>, ghci can successfully default the type variable <code>a</code> to <code>Integer</code>. But with no such instance available, defaulting fails because none of the default candidates has an instance.</p>
    
</div></body></html>